# –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–µ–ø—Ä–µ—Å—Å–∏–∏ –∏ —Å—É–∏—Ü–∏–¥–∞–ª—å–Ω—ã—Ö –º—ã—Å–ª–µ–π –≤ —Ç–µ–∫—Å—Ç–µ ü§ï

–°–æ–∑–¥–∞–Ω–æ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ª—é–¥–µ–π —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏ –ø—Å–∏—Ö–∏—á–µ—Å–∫–æ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è.

–≠—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ–∫—Å—Ç–∞ —Å —Ü–µ–ª—å—é –≤—ã—è–≤–ª–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–µ–ø—Ä–µ—Å—Å–∏–∏ –∏ —Å—É–∏—Ü–∏–¥–∞–ª—å–Ω—ã—Ö –º—ã—Å–ª–µ–π. –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –¥–ª—è –æ–∫–∞–∑–∞–Ω–∏—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ª—é–¥—è–º, –∏—Å–ø—ã—Ç—ã–≤–∞—é—â–∏–º –ø—Å–∏—Ö–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã.

## –û–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏

–í —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–Ω–∞—è –º–æ–¥–µ–ª—å **BERT**, –∞ –∏–º–µ–Ω–Ω–æ **BertForSequenceClassification** –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Transformers, –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω–∞—è –Ω–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö —Ç–µ–∫—Å—Ç–∞ –∏ —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ–º–∞—è –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞.  

–≠—Ç–∞ –º–æ–¥–µ–ª—å –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –∑–∞–¥–∞—á –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, –≥–¥–µ –Ω–∞ –≤—Ö–æ–¥ –ø–æ–¥–∞–µ—Ç—Å—è —Ç–µ–∫—Å—Ç, –∞ –Ω–∞ –≤—ã—Ö–æ–¥–µ –º–æ–¥–µ–ª—å –≤—ã–¥–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ —ç—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –∫ –æ–¥–Ω–æ–º—É –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–ª–∞—Å—Å–æ–≤. –í –Ω–µ–π —É–∂–µ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã —ç–º–±–µ–¥–¥–∏–Ω–≥–∏, –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏

–ü—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –¥–∞—Ç–∞—Å–µ—Ç [Suicide and Depression Detection](https://www.kaggle.com/datasets/nikhileswarkomati/suicide-watch) —Å —Å–∞–π—Ç–∞ Kaggle.

–î–∞—Ç–∞—Å–µ—Ç —Å–æ—Å—Ç–æ—è–ª –∏–∑ 232074 —Å–æ–æ–±—â–µ–Ω–∏–π —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –Ω–∞ –¥–≤–∞ –∫–ª–∞—Å—Å–∞ ([class_distribution.png](plots%2Fclass_distribution.png)). –í –æ–±—É—á–∞—é—â—É—é –≤—ã–±–æ—Ä–∫—É –≤–æ—à–ª–æ 80%, –æ–±—É—á–µ–Ω–∏–µ –¥–ª–∏–ª–æ—Å—å 5 —ç–ø–æ—Ö.

–ì—Ä–∞—Ñ–∏–∫ –∏—Å—Ç–æ—Ä–∏–∏ –æ–±—É—á–µ–Ω–∏—è (Loss –∏ Accuracy):

![train_history.png](plots%2Ftrain_history.png)

–û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏ –ø–æ—Å–ª–µ –∫–æ–Ω—Ü–∞ –æ–±—É—á–µ–Ω–∏—è:

```
Evaluate accuracy: 0.9851

Classification Report:
              precision    recall  f1-score   support

Non-suicidal       0.98      0.98      0.98     23199
    Suicidal       0.98      0.98      0.98     23211

    accuracy                           0.98     46410
   macro avg       0.98      0.98      0.98     46410
weighted avg       0.98      0.98      0.98     46410

```

–ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫ –ø–æ –∏—Ç–æ–≥–∞–º –æ—Ü–µ–Ω–∫–∏:

![confusion_matrix.png](plots%2Fconfusion_matrix.png)

–ü–æ –∏—Ç–æ–≥–∞–º –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª—å –ø–æ–∫–∞–∑–∞–ª–∞ –≤—ã—Å–æ–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç–æ—á–Ω–æ—Å—Ç–∏ –≤ 98.51%. –≠—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –ø–æ –º–µ—Ç–∫–∞–º –¥–ª—è –æ–±–æ–∏—Ö –∫–ª–∞—Å—Å–æ–≤. 

–í —Ü–µ–ª–æ–º, –º–æ–¥–µ–ª—å –¥–æ—Å—Ç–∏–≥–ª–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–º –º–æ–∂–Ω–æ –¥–æ–≤–µ—Ä—è—Ç—å, –ø–æ—ç—Ç–æ–º—É –æ–Ω–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –ø—Å–∏—Ö–∏—á–µ—Å–∫–æ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è –∏ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –≤ —Å–ª—É—á–∞–µ —É–≥—Ä–æ–∑—ã —Å—É–∏—Ü–∏–¥–∞.


## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
    ```bash
    git clone https://github.com/weykko/mental-health
    ```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
    ```bash
    pip install -r requirements.txt
    ```

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏

1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∞—à –¥–∞—Ç–∞—Å–µ—Ç –≤ –ø–∞–ø–∫—É `datasets`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏:
    ```bash
    python train_model.py
    ```

3. –ú–æ–¥–µ–ª—å –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–∞–ø–∫–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `model`).

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É API –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

1. –ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –º–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞, –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π:

    ```bash
    uvicorn main:app --reload
    ```

    –≠—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–µ—Ä FastAPI –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ö–æ—Å—Ç–µ.

2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ –∞–¥—Ä–µ—Å—É [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs), —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç `/predict` –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π.

### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞

- **POST** –∑–∞–ø—Ä–æ—Å –Ω–∞ `/predict` —Å JSON (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–∞—è –¥–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–∞ –æ—Ç 20 –¥–æ 128 —Å–∏–º–≤–æ–ª–æ–≤):
    ```json
    {
      "text": "I'm feeling really down today, I don't think I can go on."
    }
    ```

- –û—Ç–≤–µ—Ç:
    ```json
    {
      "prediction": "suicidal",
      "probability": 0.624
    }
    ```
