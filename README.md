# Распознавание признаков депрессии и суицидальных мыслей в тексте 

Это приложение предназначено для анализа текста с целью выявления признаков депрессии и суицидальных мыслей. Обученная модель может быть использована для оказания поддержки людям, испытывающим проблемы с психическим здоровьем.

## Описание модели

В этом проекте используется трансформерная модель **BERT**, а именно BertForSequenceClassification из библиотеки Transformers, предварительно обученная на больших объемах текста и успешно применяемая в различных задачах обработки естественного языка.  

Эта модель предназначена для задач классификации, где на вход подается текст, а на выходе модель выдает вероятность принадлежности этого текста к одному из нескольких классов.

## Результаты обучения модели

При обучении использовался датасет [Suicide and Depression Detection](https://www.kaggle.com/datasets/nikhileswarkomati/suicide-watch) с сайта Kaggle.

Датасет состоял из 232074 сообщений равномерно распределенных на два класса ([class_distribution.png](plots%2Fclass_distribution.png)). В обучающую выборку вошло 80%, обучение длилось 5 эпох.

График истории обучения (Loss и Accuracy):

![train_history.png](plots%2Ftrain_history.png)

Оценка модели после конца обучения:

```
Evaluate accuracy: 0.9851

Classification Report:
              precision    recall  f1-score   support

Non-suicidal       0.98      0.98      0.98     23199
    Suicidal       0.98      0.98      0.98     23211

    accuracy                           0.98     46410
   macro avg       0.98      0.98      0.98     46410
weighted avg       0.98      0.98      0.98     46410

```

Матрица ошибок по итогам оценки:

![confusion_matrix.png](plots%2Fconfusion_matrix.png)

По итогам обучения модель показала высокий результат точности в 98.51%. Это подтверждается стабильным результатом как по точности, так и по меткам для обоих классов. 

В целом, модель достигла результатов, которым можно доверять, поэтому она может быть эффективно использована для поддержания психического здоровья и вмешательства в случае угрозы суицида.


## Установка приложения

1. Клонируйте репозиторий:
    ```bash
    git clone https://github.com/weykko/mental-health
    ```

2. Установите все зависимости:
    ```bash
    pip install -r requirements.txt
    ```

## Инструкция по обучения модели

1. Загрузите ваш датасет в папку `datasets`
2. Запустите скрипт обучения модели:
    ```bash
    python train_model.py
    ```

3. Модель будет сохранена в указанной папке (например, `model`).

## Инструкция по запуску API приложения

1. После того как модель обучена и сохранена, вы можете запустить FastAPI приложение для получения предсказаний:

    ```bash
    uvicorn main:app --reload
    ```

    Это запустит сервер FastAPI на локальном хосте.

2. Откройте браузер и перейдите по адресу [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs), чтобы получить доступ к документации API и протестировать эндпоинт `/predict` для предсказаний.

### Пример запроса

- **POST** запрос на `/predict` с JSON телом:
    ```json
    {
      "text": "I'm feeling really down today, I don't think I can go on."
    }
    ```

- Ответ:
    ```json
    {
      "prediction": "suicidal",
      "probability": 0.876
    }
    ```
  



